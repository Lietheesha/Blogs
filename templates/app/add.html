{% extends "authenticate/base.html" %}
{% block title %}
    Add Post - My Blog
{% endblock %}

{% block content %}
<br>
    <div class="container">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <h4 class="text-center">Add a New Post</h4>
                <form method="POST" id="postForm">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="title">Title:</label>
                        <input type="text" class="form-control" style="height: 1px; width: 45%;" id="title" name="title" required>
                        <label for="content"> Content </label>
                        <textarea class="form-control" style="height: 250px;" id="content" name="content" required></textarea>
                    </div>
                    <button type="button" class="btn btn-primary mt-3" id="add"style="float: right;">Publish</button>
                    <a href="{% url 'home' %}" class="btn btn-secondary mt-3" style="padding: 6px;">Cancel</a> 
                </form>
            </div>
        </div>
    </div>
        <script>
            $(document).ready(function(){
                $('#add').on('click', function(e){
                    e.preventDefault(); // stop <a> default redirect
                    $.ajax({
                        url: '{% url "add" %}',
                        type: 'POST',
                        data: $('#postForm').serialize(), 
                        success: function() {
                            window.location.href = "{% url 'home' %}";
                        },
                        error: function(xhr, status, error) {
                            alert("An error occurred:" + error);
                        }
                    });
                });
            });
        </script>
{% endblock %} 